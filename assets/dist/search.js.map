{"version":3,"file":"search.js","mappings":"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","sources":["webpack://custom-ajax-search/./assets/src/ui.js","webpack://custom-ajax-search/./assets/src/components/preloader.js","webpack://custom-ajax-search/./assets/src/components/input/inputState.js","webpack://custom-ajax-search/./assets/src/components/resultList.js","webpack://custom-ajax-search/./assets/src/search.js","webpack://custom-ajax-search/./assets/src/components/input/inputUtils.js","webpack://custom-ajax-search/./assets/src/components/input/inputEvents.js","webpack://custom-ajax-search/./assets/src/components/input/inputHandlers.js","webpack://custom-ajax-search/./assets/src/components/input/input.js","webpack://custom-ajax-search/./assets/src/components/buttonClose.js","webpack://custom-ajax-search/./assets/src/components/buttonSearch.js","webpack://custom-ajax-search/./assets/src/events.js","webpack://custom-ajax-search/./assets/src/index.js"],"sourcesContent":["const form = document.querySelector('.cas-search-form')\n\nconst buttons = {\n    search: document.getElementById('cas-search-submit'),\n    clear: document.getElementById('cas-search-close'),\n    loading: document.getElementById('cas-search-loader'),\n}\n\nexport function expandSearchForm() {\n    form.classList.add('active')\n}\n\nexport function collapseSearchForm() {\n    form.classList.remove('active')\n}\n\nexport function updateButtonState(state) {\n    // Скрываем все кнопки\n    Object.values(buttons).forEach(button => {\n        if (button) button.style.display = 'none'\n    })\n\n    // Показываем нужную кнопку\n    if (buttons[state]) {\n        buttons[state].style.display = 'inline-block'\n    } else {\n        console.warn(`Неизвестное состояние кнопки: ${state}`)\n    }\n}","import { updateButtonState } from '../ui'\n\nconst closeButton = document.getElementById('cas-search-close')\nlet lastVisibleButton = 'search'\n\nexport function showLoader() {\n    lastVisibleButton = closeButton.style.display === 'inline-block' ? 'clear' : 'search'\n    // lastVisibleButton = lastVisibleButton === 'clear' ? 'clear' : 'search'\n\n    updateButtonState('loading')\n}\n\nexport function hideLoader() {\n    updateButtonState(lastVisibleButton)\n}\n","let lastStableInputValue = ''\nlet initialInputValue = ''\nlet inputCleared = false\nlet loading = false\nlet isBackspaceHeld = false\n\nexport function resetState({\n                               resetLastStable = true,\n                               resetInitial = true,\n                               resetCleared = true\n                           } = {}) {\n    if (resetLastStable) lastStableInputValue = ''\n    if (resetInitial) initialInputValue = ''\n    if (resetCleared) inputCleared = true\n}\n\nexport function setLoading(state) {\n    loading = state\n}\n\nexport function isLoading() {\n    return loading\n}\n\nexport function getLastStableInputValue() {\n    return lastStableInputValue\n}\n\nexport function setLastStableInputValue(value) {\n    lastStableInputValue = value\n}\n\nexport function wasInputCleared() {\n    return inputCleared\n}\n\nexport function resetInputCleared() {\n    inputCleared = false\n}\n\nexport function setInitialInputValue(value) {\n    initialInputValue = value\n}\n\nexport function resetInitialInputValue() {\n    initialInputValue = ''\n}\n\nexport function resetInputValue(input) {\n    input.value = ''\n}\n\nexport function setBackspaceState(state) {\n    isBackspaceHeld = state\n}\n\nexport function isBackspaceActive() {\n    return isBackspaceHeld\n}","export function clearResults(resultsContainer) {\n    resultsContainer.innerHTML = ''\n}\n\nexport function showResults(resultsContainer) {\n    if (resultsContainer.innerHTML.trim() !== '') {\n        resultsContainer.style.display = 'block'\n    }\n}\n\nexport function hideResults(resultsContainer) {\n    setTimeout(() => {\n        resultsContainer.style.display = 'none'\n    }, 300)\n}\n","/* global cas_ajax */\n\nimport { showLoader, hideLoader } from './components/preloader'\nimport { isLoading, setLoading } from './components/input/inputState'\nimport { clearResults, showResults } from './components/resultList.js'\n\nexport default function performSearch(query, resultsContainer) {\n    if (!query.trim() || query.length <= 3) {\n        clearResults(resultsContainer)\n        return\n    }\n\n    console.log('Search load 1')\n    console.log('Current NODE_ENV:', process.env.NODE_ENV)\n\n\n    if (isLoading()) return\n\n    setLoading(true)\n    showLoader()\n\n    fetch(cas_ajax.ajaxurl, {\n        method: 'POST',\n        headers: {'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'},\n        body: new URLSearchParams({\n            action: 'cas_ajax_search',\n            search: query,\n            nonce: cas_ajax.nonce,\n        }),\n    })\n        .then((response) => response.json())\n        .then((data) => {\n            setLoading(false)\n            hideLoader()\n            clearResults(resultsContainer)\n\n            if (data.success && data.data.length > 0) {\n                resultsContainer.innerHTML = data.data.map(\n                    (post) => `<li><a href=\"${post.link}\">${post.title}</a><p>${post.excerpt}</p></li>`\n                ).join('')\n\n                // Показываем результаты после их обновления\n                showResults(resultsContainer)\n            } else {\n                resultsContainer.innerHTML = '<li>Нет результатов</li>'\n                showResults(resultsContainer)\n            }\n        })\n        .catch((error) => {\n            setLoading(false)\n            hideLoader()\n            console.error('Search error:', error)\n        })\n}\n","const search =  document.getElementById('cas-search')\nexport function normalizeText(text) {\n    return text.replace(/\\s+/g, '').toLowerCase()\n}\n\nexport function blurInput() {\n    search.blur()\n}","import performSearch from '../../search.js'\nimport { clearResults, hideResults, showResults } from '../resultList.js'\nimport {\n    setLoading,\n    isLoading,\n    getLastStableInputValue,\n    setLastStableInputValue,\n    wasInputCleared,\n    resetInputCleared,\n    resetState,\n    setInitialInputValue,\n    isBackspaceActive,\n    setBackspaceState,\n} from './inputState.js'\nimport { normalizeText } from './inputUtils.js'\nimport { updateButtonState } from '../../ui'\n\nconst SEARCH_DELAY = 700\nlet timeoutId\n\nexport function onInput(event, input, resultsContainer) {\n    //if (isBackspaceActive() && !isLoading()) return\n\n    if (isLoading()) {\n        event.preventDefault()\n        input.value = getLastStableInputValue()\n        return\n    }\n\n    clearTimeout(timeoutId)\n\n    const currentValue = input.value.trim()\n\n    if (currentValue === '') {\n        resetState({ resetInitial: false })\n\n        clearResults(resultsContainer)\n        hideResults(resultsContainer)\n\n        updateButtonState('search')\n\n        return\n    }\n\n    if (currentValue.length <= 3) {\n        resetState()\n    }\n\n    if (currentValue.length <= 3 && resultsContainer.querySelectorAll('li').length !== 0) {\n        setLoading(false)\n        clearResults(resultsContainer)\n        hideResults(resultsContainer)\n    }\n\n    if (wasInputCleared()) {\n        setInitialInputValue(currentValue)\n        resetInputCleared()\n    }\n\n    if (normalizeText(currentValue) === normalizeText(getLastStableInputValue())) {\n        return\n    }\n\n    updateButtonState(currentValue.length > 0 ? 'clear' : 'search')\n\n    if (currentValue.length < 3) return\n\n    timeoutId = setTimeout(() => {\n        if (!isLoading()) {\n            if (isBackspaceActive()) return\n            if (normalizeText(currentValue) === normalizeText(getLastStableInputValue())) return\n\n            performSearch(currentValue, resultsContainer)\n            setLastStableInputValue(currentValue)\n        }\n    }, SEARCH_DELAY)\n}\n\nexport function onCut(event, input, resultsContainer) {\n    if (isLoading()) {\n        event.preventDefault()\n        return\n    }\n\n    setTimeout(() => {\n        if (input.value.trim() === '') {\n            clearResults(resultsContainer)\n            hideResults(resultsContainer)\n\n            updateButtonState('search')\n        }\n    }, 10)\n}\n\nexport function onClick(resultsContainer) {\n    showResults(resultsContainer)\n}\n\nexport function onKeydown(event) {\n    if (event.key === 'Backspace') {\n        setBackspaceState(true)\n    }\n}\n\nexport function onKeyup(event) {\n    if (event.key === 'Backspace') {\n        setBackspaceState(false)\n    }\n}","import { onInput, onCut, onClick, onKeydown, onKeyup } from './inputEvents.js'\n\nexport function initInputHandlers(input, resultsContainer) {\n    input.addEventListener('input', (event) => onInput(event, input, resultsContainer))\n    input.addEventListener('cut', (event) => onCut(event, input, resultsContainer))\n    input.addEventListener('click', () => onClick(resultsContainer))\n    input.addEventListener('keydown', (event) => onKeydown(event))\n    input.addEventListener('keyup', (event) => onKeyup(event))\n}\n","import { initInputHandlers } from './inputHandlers.js'\nimport { resetState, isLoading, resetInputValue } from './inputState.js'\n\nconst input = document.getElementById('cas-search')\nlet timeoutId\n\nexport function initInputEvents(resultsContainer) {\n    initInputHandlers(input, resultsContainer)\n}\n\n// 🛠 Очистка поля ввода\nexport function clearInput() {\n    if (isLoading()) return // Запрещаем очистку во время поиска\n\n    resetState()\n    resetInputValue(input)\n    clearTimeout(timeoutId)\n}\n","import { collapseSearchForm, updateButtonState } from '../ui.js'\nimport { blurInput } from './input/inputUtils'\nimport { clearInput} from './input/input'\nimport { isLoading, resetInitialInputValue, setLoading } from './input/inputState'\nimport { clearResults, hideResults } from './resultList.js'\n\nconst closeButton = document.getElementById('cas-search-close')\n\nlet timeoutId\n\nexport function initCloseButton(resultsContainer) {\n    function closeSearch(event) {\n        if (event) event.preventDefault()\n\n        clearTimeout(timeoutId) // Отменяем запущенный поиск\n        setLoading(false) // Разрешаем дальнейшие действия\n\n        blurInput()\n        collapseSearchForm()\n        clearInput()\n\n        resetInitialInputValue() // 🛠 Теперь `initialInputValue` сбрасывается!\n\n        clearResults(resultsContainer)\n        hideResults(resultsContainer)\n\n        updateButtonState('search')\n    }\n\n    closeButton.addEventListener('click', closeSearch)\n\n    document.addEventListener('keydown', (event) => {\n        if (event.key === 'Escape' && !isLoading()) {\n            closeSearch()\n        }\n    })\n}","import { expandSearchForm, updateButtonState } from '../ui.js'\nimport performSearch from '../search.js'\n\nconst searchButton = document.getElementById('cas-search-submit')\n\nexport function initSearchButton(resultsContainer) {\n    searchButton.addEventListener('click', (event) => {\n        event.preventDefault()\n        expandSearchForm()\n        updateButtonState('clear')\n\n        document.getElementById('cas-search').focus()\n\n        if (document.getElementById('cas-search').value.trim() !== '') {\n            performSearch(document.getElementById('cas-search').value, resultsContainer)\n        }\n    })\n}","import { initInputEvents } from './components/input/input.js'\nimport { blurInput } from './components/input/inputUtils'\nimport { initCloseButton } from './components/buttonClose.js'\nimport { initSearchButton } from './components/buttonSearch.js'\nimport { hideResults } from './components/resultList.js'\n\nexport default function initSearchEvents() {\n    const form = document.querySelector('.cas-search-form')\n    const resultsContainer = document.getElementById('cas-search-results')\n\n    initInputEvents(resultsContainer)\n    initSearchButton(resultsContainer)\n    initCloseButton(resultsContainer)\n\n    document.addEventListener('click', (event) => {\n        if (!form.contains(event.target) && !resultsContainer.contains(event.target)) {\n            blurInput()\n            hideResults(resultsContainer)\n        }\n    })\n}\n","import initSearchEvents from './events.js'\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    initSearchEvents()\n})\n"],"names":["form","document","querySelector","buttons","search","getElementById","clear","loading","expandSearchForm","classList","add","collapseSearchForm","remove","updateButtonState","state","Object","values","forEach","button","style","display","console","warn","closeButton","lastVisibleButton","showLoader","hideLoader","lastStableInputValue","initialInputValue","inputCleared","isBackspaceHeld","resetState","resetLastStable","resetInitial","resetCleared","arguments","length","undefined","setLoading","isLoading","getLastStableInputValue","setLastStableInputValue","value","wasInputCleared","resetInputCleared","setInitialInputValue","resetInitialInputValue","resetInputValue","input","setBackspaceState","isBackspaceActive","clearResults","resultsContainer","innerHTML","showResults","trim","hideResults","setTimeout","performSearch","query","log","process","env","NODE_ENV","fetch","cas_ajax","ajaxurl","method","headers","body","URLSearchParams","action","nonce","then","response","json","data","success","map","post","link","title","excerpt","join","catch","error","normalizeText","text","replace","toLowerCase","blurInput","blur","SEARCH_DELAY","timeoutId","onInput","event","preventDefault","clearTimeout","currentValue","querySelectorAll","onCut","onClick","onKeydown","key","onKeyup","initInputHandlers","addEventListener","initInputEvents","clearInput","initCloseButton","closeSearch","searchButton","initSearchButton","focus","initSearchEvents","contains","target"],"sourceRoot":""}